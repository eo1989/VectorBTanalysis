"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const coreutils_1 = require("@jupyterlab/coreutils");
const services_1 = require("@jupyterlab/services");
const constants_1 = require("./constants");
class JupyterlabCodeFormatterClient {
    request(path, method, body) {
        const settings = services_1.ServerConnection.makeSettings();
        const fullUrl = coreutils_1.URLExt.join(settings.baseUrl, constants_1.Constants.SHORT_PLUGIN_NAME, path);
        return services_1.ServerConnection.makeRequest(fullUrl, {
            body,
            method,
            headers: new Headers({
                'Plugin-Version': constants_1.Constants.PLUGIN_VERSION
            })
        }, settings).then(response => {
            if (response.status !== 200) {
                return response.text().then(() => {
                    throw new services_1.ServerConnection.ResponseError(response, response.statusText);
                });
            }
            return response.text();
        });
    }
    getAvailableFormatters() {
        return this.request('formatters', 'GET', null);
    }
    getVersion() {
        return this.request('version', 'GET', null);
    }
}
exports.default = JupyterlabCodeFormatterClient;
